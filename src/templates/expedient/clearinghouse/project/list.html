{% extends "iframebase.html" %}
{% load ch_extras %}

{% block scripts %}
<script>
	{% include "users/tooltip.js" %}
	$(document).ready(function() {
		addTooltipToClass("slicecontinue");
	});
</script>
{% endblock %}

{% block title %}List Projects{% endblock title %}
{% block content %}
<div class="project_list">
	<div class="table_div">
		<table class="fulltable" id="projects_table">
			<tr>
				<th class="name">Name</th>
                <th class="owners">Owners</th>
                <th class="members">Members</th>
                <th class="slices">Slices</th>
                <th class="actions">Actions</th>
			</tr>
			{% for project in project_list %}
			<tr>
				<td class="name">{{ project.name }}</td>
				<td class="owners">
					{% with project.owners.all as users %}
					{% include "users/tooltiplist.html" %}
					{% endwith %}
				</td>
                <td class="members">
					{% with project.members.all as users %}
					{% include "users/tooltiplist.html" %}
					{% endwith %}
                </td>
                <td class="slices">
                	{% for slice in project.slice_set.all %}
					{% if forloop.counter < 2 %}
                	<a href="{% url slice_detail slice.id %}">{{ slice.name }}</a>{% if not forloop.last %},{% endif %}
					{% else %}
					{% if forloop.counter == 2 %}
					<div class="val slicecontinue">...</div>
					<div class="description slicecontinue">
					{% endif %}
						<a href="{% url slice_detail slice.id %}">{{ slice.name }}</a>{% if not forloop.last %},{% endif %}
					{% if forloop.last %}
					</div>
					{% endif %}
					{% endif %}
					{% endfor %}
                </td>
				<td class="actions">
					<a href="{% url project_iframe_update project.id %}">update</a>,
					<a href="{% url project_detail project.id %}">details</a>,
					<a href="{% url project_delete project.id %}">delete</a>
				</td>
			</tr>
			{% endfor %}
		</table>
	</div>
    <div class="create_project">
        <input type="button" value="Create"
        onclick="document.location='{% url project_create %}'"/>
    </div>
</div>
{% endblock content %}
